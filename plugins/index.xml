<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Plugins-rsses on Remco Docs</title>
    <link>https://heavyhorst.github.io/remco/plugins/index.xml</link>
    <description>Recent content in Plugins-rsses on Remco Docs</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Released under the MIT license</copyright>
    <atom:link href="https://heavyhorst.github.io/remco/plugins/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>plugins</title>
      <link>https://heavyhorst.github.io/remco/plugins/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://heavyhorst.github.io/remco/plugins/</guid>
      <description>

&lt;h2 id=&#34;env-backend-as-plugin-example&#34;&gt;ENV backend as plugin [Example]&lt;/h2&gt;

&lt;p&gt;This is the env backend as a plugin.
If you want to try it yourself, then
just compile it and move the executable to /etc/remco/plugins.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;package main

import (
	&amp;quot;context&amp;quot;
	&amp;quot;log&amp;quot;
	&amp;quot;net/rpc/jsonrpc&amp;quot;

	&amp;quot;github.com/HeavyHorst/easyKV&amp;quot;
	&amp;quot;github.com/HeavyHorst/easyKV/env&amp;quot;
	&amp;quot;github.com/HeavyHorst/remco/backends/plugin&amp;quot;
	&amp;quot;github.com/natefinch/pie&amp;quot;
)

func main() {
	p := pie.NewProvider()
	if err := p.RegisterName(&amp;quot;Plugin&amp;quot;, &amp;amp;EnvRPCServer{}); err != nil {
		log.Fatalf(&amp;quot;failed to register Plugin: %s&amp;quot;, err)
	}
	p.ServeCodec(jsonrpc.NewServerCodec)
}

type EnvRPCServer struct {
	// This is the real implementation
	Impl easyKV.ReadWatcher
}

func (e *EnvRPCServer) Init(args map[string]interface{}, resp *bool) error {
	// use the data in args to create the ReadWatcher
	// env var doesn&#39;t need any data

	var err error
	e.Impl, err = env.New()
	return err
}

func (e *EnvRPCServer) GetValues(args []string, resp *map[string]string) error {
	erg, err := e.Impl.GetValues(args)
	if err != nil {
		return err
	}
	*resp = erg
	return nil
}

func (e *EnvRPCServer) Close(args interface{}, resp *interface{}) error {
	e.Impl.Close()
	return nil
}

func (e EnvRPCServer) WatchPrefix(args plugin.WatchConfig, resp *uint64) error {
	var err error
	*resp, err = e.Impl.WatchPrefix(args.Prefix, context.Background(), easyKV.WithKeys(args.Opts.Keys), easyKV.WithWaitIndex(args.Opts.WaitIndex))
	return err
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then create a config file with this backend section.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-toml&#34;&gt;[backend]
  [[backend.plugin]]
    path = &amp;quot;/etc/remco/plugins/env&amp;quot;
    keys = [&amp;quot;/&amp;quot;]
    interval = 60
	watch = false
	[backend.plugin.config]
	 # these parameters are not used in the env backend plugin
	 # but other plugins may need some data (password, prefix ...)
	 a = &amp;quot;hallo&amp;quot;
	 b = &amp;quot;moin&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>